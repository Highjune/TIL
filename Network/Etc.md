# 개념정리

- 외부IP : (네이버에서 확인가능)
    - 외부ip = 공인ip
    - 유무선공유기의 외부ip
    - 집 안에 형성된 네트워크의 라우터 주소(통신사의 아주 큰 외부 네트워크 안에 있는 하나의 라우터 주소), 그래서 노트북이랑 스마트폰이 같은 네트워크 아래에 있을 시 네트워크의 주소가 동일할 것이다.
    - 확인방법 : 네이버에서 '내 아이피' 검색 or 주소창에 [https://ipinfo.io/ip](https://ipinfo.io/ip) 검색 or cmd창에서 curl `ipinfo.io/ip`
    - 고정ip가 아니다. 모뎀이 24시간 계속 사용 상태이다 보니, 기기의 전원을 off/on 하지 않는 이상 ip가 거의 변경되지 않으므로 고정ip처럼 보일 뿐.
    - 언제라도 바뀔 수 있는 유동 ip
- 내부IP : 192.168.x.xx(cmd의 ip4 주소)
    - 내부ip = 사설ip
    - 하나의 공유기 네트워크 망 안에 있는 기기들은 모두 192.168.0.x이라는 것을 할당받는다. x는 DHCP에 의해서 자동으로 할당. 물론 고정으로 설정할 수도 있다.
    - 보통 192.168.0.1 의 포맷이나 10.0.0.1 의 포맷 등처럼 자주 사용하는 포맷이 있는데 꼭 따를 필요는 없다.

- 유동ip
    - 개인은 모두 유동ip. 아이피 바뀜
    - ex) 개인사용자(대부분).

- 고정ip
    - 서버 운영 등 특수성, 홍보목적 등

- 게이트웨이
    - 사용자가 있는 해당 네트워크에서 다른 네트워크로 나갈 때 반드시 거쳐야 하는 출구 또는 거점
    - 기본 게이트웨이 : 게이트웨이가 여러 개일 때 기본적으로 사용하도록 지정해 놓은 게이트웨이
    - 게이트웨이 주소는 개발자 마음대로 정할 수 있지만, 보통은 가용 호스트 주소 중에 첫번째 주소 또는 마지막 주소를 주로 사용


# 집 안에 있는 기기를 서버로 사용하려면?
- 기기들이 24시간 켜져 있어야 한다. 노트북을 덮어도 기기가 꺼지지 않도록 설정하거나 미니 피씨를 둬서 할 수도 있다.
- skt 공유기 밑에 it-time이 있음.
- 외부 아이피(ex. 1.1.1.1), DNS로 도메인 mapping은 하지 않은 상태.
- 공유기 밑에 있는 3대의 기기 
    - 공유기 : 192.168.0.1 - 보통 공유기는 192.168.0.1로 설정
    1. pc : ex) 192.168.0.10 
    2. Web-server, api-server : ex) 192.168.0.20
        - Web-server로서 nginx(기본 포트 : 80 또는 443) 설치되었다는 가정
        - Api-server로서 embedded tomcat(기본 포트 : 25001) 설치되었다는 가정
    3. DB-server : ex) 192.168.0.30
        - DB-server로서 mysql(기본 포트 : 3306) 설치되었다는 가정

- 포트 포워딩(port forwarding) 을 해야 한다.
    - 공유기 환경설정에서 하는 것. skt는 접근을 막아둬서 보통 kt
    - 인터넷이 연결되어 있다는 전제
    - 아래를 설정하는 것이 포트 포워딩
        - 1.1.1.1:80(또는 443) 이면 192.168.0.20 (2번 Web-Server) 로 연결되도록.
        - 1.1.1.1:3306 이면 192.168.0.30 (3번 pc) 로 연결되도록.

- 위처럼 설정을 하면 전기세 이외에 비용 0
- 집에서 윈도우 노트북1대, 맥 노트북 1대가 있다면? 나처럼.
    - 윈도우에 apache나 nginx 설치하거나, 윈도우10 IIS같은 경우는 접속자 제한이 있음
    - 또는 APM을 설치해서 apache, php, mysql 동시에 설치하는 패키지 같은 것을 사용하거나
# 같은 네트워크 망 안에 있는 피씨(인스턴스)들은 내부 ip로 접근이 가능하다.
- AWS에서 동일한 VPC id를 가진 가상의 네트워크 밑에 여러 서브넷 id 그룹을 생성할 수 있다.
    - VPC는 Virtual Private Cloud. 사용자의 AWS 계정 전용 가상 네트워크.
    - 서브넷은 VPC 안에 네트워크망. A class, B class, C class 단위로 만듬. 동일한 클래스에 속한 여러 인스턴스(ex. soccer1, soccer2, soccer3)들은 같은 내부망에 있으므로 서로 내부ip로 접근이 가능하다. 
    - 그런데 같은 서브넷 안에 있는 인스턴스들이 서로 외부 ip를 호출하면 해당하는 서브넷의 망을 나갔다가 다시 들어와야 하므로 방화벽을 열어줘야 한다.
        - 만약 soccer1(외부ip:100번, 내부ip:10.0.0.1번)이 soccer2(외부ip:101번, 내부ip:10.0.0.2번)에 접근할 때 내부ip인 10.0.0.2번으로 접근하면 바로 연결 가능한데, 만약 외부ip인 101번을 호출하면 해당하는 `서브넷(?)`에서 방화벽을 열어줘야 한다.
    - 보통 동일한 서브넷으로 이름 붙여서(ex. soccer_subnet, baseball_subnet 등)그 안에 다 넣어둔다. 그게 하나의 네트워크(서브넷) 영역임
        - soccer_subnet을 class C로 묶었다고 하면 `xxx.xxx.xxx.값` 으로 그 안에는 다 동일한 네트워크 망이다.

- AWS) 처음 인스턴스 생성할 때 네트워크를 어떻게 할 지 설정을 따로 한다.
- 만약 회사의 로컬에서 특정 서버의 DB로 접근할 때 그 특정 서버의 외부ip를 사용해서 접속이 가능하다면, 그것은 그 특정 서버에서 우리 회사에 대해 방화벽을 열어주었기 때문이다ㅏ.


# Ip4의 구성
## 클래스
![image](https://user-images.githubusercontent.com/57219160/140891801-b35967eb-1bc6-4338-838c-b839d8545c99.png)
-동일한 클래스 밑은 다 같은 영역에 속한다. A 클래스 값이 동일한 애들은 서로 같은 영역. A, B클래스 값이 동일한 애들은 서로 같은 영역. A, B, C클래스 값이 동일한 애들은 서로 같은 영역(ex. 10.0.0.1, 10.0.0.2, 10.0.0.3 ..)



# 설정정보(ex. application.properties) 에 내부 ip를 사용하는 이유
- 내부 ip를 사용하게 되면 외부망 층을 거치지 않고 내부망 층에서 바로 port로 찾아간다.
    - 외부망까지 나갔다가(어? 그 주소가 나네? 하고 다시 들어옴) 들어오면 그 해당하는 포트를 열어줘야 함.
- 물론 외부 ip를 사용해도 상관없다.
- 내부머신은 자기 자신의 외부 ip를 알지 못한다.

